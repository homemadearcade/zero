{"version":3,"sources":["../../src/utils/utils.js"],"names":["readdir","fs","unlink","deleteAllAvatars","absoluteFolderPath","files","unlinkPromises","map","filename","includes","console","log","Promise","all","err","isValidUrl","str","urlRegex","url","RegExp","length","test","isObject","item","Array","isArray","mergeDeep","target","sources","source","shift","key","Object","assign"],"mappings":";;;;;;;;;;AAAA;;AACA;;;;AACA,MAAMA,OAAO,GAAG,qBAAUC,YAAGD,OAAb,CAAhB;AACA,MAAME,MAAM,GAAG,qBAAUD,YAAGC,MAAb,CAAf;;AAEO,MAAMC,gBAAgB,GAAG,MAAOC,kBAAP,IAA8B;AAC5D,MAAI;AACF,UAAMC,KAAK,GAAG,MAAML,OAAO,CAACI,kBAAD,CAA3B;AACA,UAAME,cAAc,GAAGD,KAAK,CAACE,GAAN,CAAWC,QAAD,IAAc;AAC7C,UAAI,CAAC,CAAC,aAAD,EAAgB,aAAhB,EAA+B,aAA/B,EAA8CC,QAA9C,CAAuDD,QAAvD,CAAL,EAAuE;AACrEE,QAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCH,QAAjC;AACAN,QAAAA,MAAM,CAAE,GAAEE,kBAAmB,IAAGI,QAAS,EAAnC,CAAN;AACD;AACF,KALsB,CAAvB;AAMA,WAAOI,OAAO,CAACC,GAAR,CAAYP,cAAZ,CAAP;AACD,GATD,CASE,OAAOQ,GAAP,EAAY;AACZJ,IAAAA,OAAO,CAACC,GAAR,CAAYG,GAAZ;AACD;AACF,CAbM;;;;AAeA,MAAMC,UAAU,GAAIC,GAAD,IAAS;AACjC,MAAIC,QAAQ,GACV,6YADF;AAEA,MAAIC,GAAG,GAAG,IAAIC,MAAJ,CAAWF,QAAX,EAAqB,GAArB,CAAV;AACA,SAAOD,GAAG,CAACI,MAAJ,GAAa,IAAb,IAAqBF,GAAG,CAACG,IAAJ,CAASL,GAAT,CAA5B;AACD,CALM;AAOP;AACA;AACA;AACA;AACA;;;;;AACQ,SAASM,QAAT,CAAkBC,IAAlB,EAAwB;AAC9B,SAAQA,IAAI,IAAI,OAAOA,IAAP,KAAgB,QAAxB,IAAoC,CAACC,KAAK,CAACC,OAAN,CAAcF,IAAd,CAA7C;AACD;AACD;AACA;AACA;AACA;AACA;;;AACQ,SAASG,SAAT,CAAmBC,MAAnB,EAA2B,GAAGC,OAA9B,EAAuC;AAC7C,MAAI,CAACA,OAAO,CAACR,MAAb,EAAqB,OAAOO,MAAP;AACrB,QAAME,MAAM,GAAGD,OAAO,CAACE,KAAR,EAAf;;AAEA,MAAIR,QAAQ,CAACK,MAAD,CAAR,IAAoBL,QAAQ,CAACO,MAAD,CAAhC,EAA0C;AACxC,SAAK,MAAME,GAAX,IAAkBF,MAAlB,EAA0B;AACxB,UAAIP,QAAQ,CAACO,MAAM,CAACE,GAAD,CAAP,CAAZ,EAA2B;AACzB,YAAI,CAACJ,MAAM,CAACI,GAAD,CAAX,EAAkBC,MAAM,CAACC,MAAP,CAAcN,MAAd,EAAsB;AAAE,WAACI,GAAD,GAAO;AAAT,SAAtB;AAClBL,QAAAA,SAAS,CAACC,MAAM,CAACI,GAAD,CAAP,EAAcF,MAAM,CAACE,GAAD,CAApB,CAAT;AACD,OAHD,MAGO;AACLC,QAAAA,MAAM,CAACC,MAAP,CAAcN,MAAd,EAAsB;AAAE,WAACI,GAAD,GAAOF,MAAM,CAACE,GAAD;AAAf,SAAtB;AACD;AACF;AACF;;AAED,SAAOL,SAAS,CAACC,MAAD,EAAS,GAAGC,OAAZ,CAAhB;AACD","sourcesContent":["import fs from 'fs';\nimport { promisify } from 'util';\nconst readdir = promisify(fs.readdir);\nconst unlink = promisify(fs.unlink);\n\nexport const deleteAllAvatars = async (absoluteFolderPath) => {\n  try {\n    const files = await readdir(absoluteFolderPath);\n    const unlinkPromises = files.map((filename) => {\n      if (!['avatar0.jpg', 'avatar1.jpg', 'avatar2.jpg'].includes(filename)) {\n        console.log('Deleting avatar: ', filename);\n        unlink(`${absoluteFolderPath}/${filename}`);\n      }\n    });\n    return Promise.all(unlinkPromises);\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nexport const isValidUrl = (str) => {\n  var urlRegex =\n    '^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\\\S+(?::\\\\S*)?@)?(?:(?:(?:[1-9]\\\\d?|1\\\\d\\\\d|2[01]\\\\d|22[0-3])(?:\\\\.(?:1?\\\\d{1,2}|2[0-4]\\\\d|25[0-5])){2}(?:\\\\.(?:[0-9]\\\\d?|1\\\\d\\\\d|2[0-4]\\\\d|25[0-4]))|(?:(?:[a-z\\\\u00a1-\\\\uffff0-9]+-?)*[a-z\\\\u00a1-\\\\uffff0-9]+)(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff0-9]+-?)*[a-z\\\\u00a1-\\\\uffff0-9]+)*(?:\\\\.(?:[a-z\\\\u00a1-\\\\uffff]{2,})))|localhost)(?::\\\\d{2,5})?(?:(/|\\\\?|#)[^\\\\s]*)?$';\n  var url = new RegExp(urlRegex, 'i');\n  return str.length < 2083 && url.test(str);\n};\n\n/**\n * Simple object check.\n * @param item\n * @returns {boolean}\n */\n export function isObject(item) {\n  return (item && typeof item === 'object' && !Array.isArray(item));\n}\n/**\n * Deep merge two objects.\n * @param target\n * @param ...sources\n */\n export function mergeDeep(target, ...sources) {\n  if (!sources.length) return target;\n  const source = sources.shift();\n\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) Object.assign(target, { [key]: {} });\n        mergeDeep(target[key], source[key]);\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return mergeDeep(target, ...sources);\n}\n\n"],"file":"utils.js"}